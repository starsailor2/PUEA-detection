\begin{figure}[htbp]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=13cm,
            height=8cm,
            ybar,
            bar width=12pt,
            ylabel style={font=\bfseries},
            ylabel={Detection Rate (\%)},
            symbolic x coords={DBSCAN, K-means, Agglomerative, Spectral},
            xtick=data,
            ymin=65, ymax=104,
            legend style={
                at={(0.5,-0.18)}, 
                anchor=north, 
                legend columns=3,
                font=\small\bfseries,
                draw=black!30,
                fill=white!95,
                rounded corners,
                drop shadow
            },
            ylabel near ticks,
            ymajorgrids=true,
            grid style={dotted, gray!30},
            nodes near coords={\pgfmathprintnumber{\pgfplotspointmeta}\%},
            every node near coord/.append style={font=\scriptsize\bfseries, rotate=0, anchor=south, yshift=6pt},
            title style={font=\Large\bfseries, text=blue!60!black},
            title={Detection Performance in Scenario A (Far)},
            axis background/.style={fill=blue!2},
            xticklabel style={font=\bfseries\small},
            enlarge x limits=0.15,
            visualization depends on={value \thisrow{color} \as \mycolor},
            ]
            
            \addplot[fill=blue!60, draw=black!50, thick, postaction={
                pattern=north east lines, pattern color=blue!80!black
            }] coordinates {
                (DBSCAN, 87.3)
                (K-means, 88.7)
                (Agglomerative, 89.5)
                (Spectral, 86.8)
            };
            \addlegendentry{Traditional}
            
            \addplot[fill=green!60, draw=black!50, thick, postaction={
                pattern=grid, pattern color=green!80!black
            }] coordinates {
                (DBSCAN, 92.5)
                (K-means, 94.6)
                (Agglomerative, 95.2)
                (Spectral, 93.1)
            };
            \addlegendentry{With KNN}
            
            \addplot[fill=orange!60, draw=black!50, thick, postaction={
                pattern=crosshatch, pattern color=orange!80!black
            }] coordinates {
                (DBSCAN, 91.2)
                (K-means, 93.4)
                (Agglomerative, 93.7)
                (Spectral, 91.8)
            };
            \addlegendentry{With Means}

            % Adding labels for best performing method
            \node[anchor=south, font=\scriptsize\bfseries, text=green!50!black, yshift=5pt] at (axis cs:Agglomerative,98) {Best Performance};
            \draw[->, >=stealth, thick, green!50!black] (axis cs:Agglomerative,97.5) -- (axis cs:Agglomerative,95.8);
            
        \end{axis}
    \end{tikzpicture}
    \caption{Detection rate comparison between traditional clustering algorithms and their enhanced versions in Scenario A (Far). The enhanced versions with KNN consistently outperform traditional methods, with Agglomerative Hierarchical Clustering achieving the highest detection rate of 95.2\%.}
    \label{fig:detection_comparison_A_enhanced}
\end{figure}

\begin{figure}[htbp]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=13cm,
            height=8cm,
            ybar,
            bar width=12pt,
            ylabel style={font=\bfseries},
            ylabel={Detection Rate (\%)},
            symbolic x coords={DBSCAN, K-means, Agglomerative, Spectral},
            xtick=data,
            ymin=60, ymax=100,
            legend style={
                at={(0.5,-0.18)}, 
                anchor=north, 
                legend columns=3,
                font=\small\bfseries,
                draw=black!30,
                fill=white!95,
                rounded corners,
                drop shadow
            },
            ylabel near ticks,
            ymajorgrids=true,
            grid style={dotted, gray!30},
            nodes near coords={\pgfmathprintnumber{\pgfplotspointmeta}\%},
            every node near coord/.append style={font=\scriptsize\bfseries, rotate=0, anchor=south, yshift=6pt},
            title style={font=\Large\bfseries, text=blue!60!black},
            title={Detection Performance in Scenario B (Medium)},
            axis background/.style={fill=blue!2},
            xticklabel style={font=\bfseries\small},
            enlarge x limits=0.15,
            ]
            
            \addplot[fill=blue!60, draw=black!50, thick, postaction={
                pattern=north east lines, pattern color=blue!80!black
            }] coordinates {
                (DBSCAN, 81.2)
                (K-means, 83.6)
                (Agglomerative, 84.3)
                (Spectral, 82.5)
            };
            \addlegendentry{Traditional}
            
            \addplot[fill=green!60, draw=black!50, thick, postaction={
                pattern=grid, pattern color=green!80!black
            }] coordinates {
                (DBSCAN, 88.7)
                (K-means, 91.5)
                (Agglomerative, 92.1)
                (Spectral, 90.3)
            };
            \addlegendentry{With KNN}
            
            \addplot[fill=orange!60, draw=black!50, thick, postaction={
                pattern=crosshatch, pattern color=orange!80!black
            }] coordinates {
                (DBSCAN, 87.1)
                (K-means, 89.8)
                (Agglomerative, 90.5)
                (Spectral, 88.6)
            };
            \addlegendentry{With Means}
            
            % Adding labels for best performing method
            \node[anchor=south, font=\scriptsize\bfseries, text=green!50!black, yshift=5pt] at (axis cs:Agglomerative,95) {Best Performance};
            \draw[->, >=stealth, thick, green!50!black] (axis cs:Agglomerative,94.5) -- (axis cs:Agglomerative,92.7);
            
            % Add performance improvement annotation
            \draw[<->, >=stealth, thick, red!60!black] (axis cs:Agglomerative,85) -- (axis cs:Agglomerative,91);
            \node[anchor=west, font=\scriptsize\bfseries, text=red!60!black] at (axis cs:Agglomerative,88) {+7.8\%};
            
        \end{axis}
    \end{tikzpicture}
    \caption{Detection rate comparison between traditional clustering algorithms and their enhanced versions in Scenario B (Medium). The enhanced versions with KNN show significant improvement over traditional methods, with Agglomerative Hierarchical Clustering achieving the highest detection rate of 92.1\%.}
    \label{fig:detection_comparison_B_enhanced}
\end{figure}

\begin{figure}[htbp]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=13cm,
            height=8cm,
            ybar,
            bar width=12pt,
            ylabel style={font=\bfseries},
            ylabel={Detection Rate (\%)},
            xlabel={\textbf{Algorithm}},
            symbolic x coords={DBSCAN, K-means, Agglomerative, Spectral},
            xtick=data,
            ymin=55, ymax=100,
            legend style={
                at={(0.5,-0.18)}, 
                anchor=north, 
                legend columns=3,
                font=\small\bfseries,
                draw=black!30,
                fill=white!95,
                rounded corners,
                drop shadow
            },
            ylabel near ticks,
            ymajorgrids=true,
            grid style={dotted, gray!30},
            nodes near coords={\pgfmathprintnumber{\pgfplotspointmeta}\%},
            every node near coord/.append style={font=\scriptsize\bfseries, rotate=0, anchor=south, yshift=6pt},
            title style={font=\Large\bfseries, text=blue!60!black},
            title={Detection Performance in Scenario C (Near)},
            axis background/.style={fill=blue!2},
            xticklabel style={font=\bfseries\small},
            enlarge x limits=0.15,
            ]
            
            \addplot[fill=blue!60, draw=black!50, thick, postaction={
                pattern=north east lines, pattern color=blue!80!black
            }] coordinates {
                (DBSCAN, 76.5)
                (K-means, 79.2)
                (Agglomerative, 80.1)
                (Spectral, 77.8)
            };
            \addlegendentry{Traditional}
            
            \addplot[fill=green!60, draw=black!50, thick, postaction={
                pattern=grid, pattern color=green!80!black
            }] coordinates {
                (DBSCAN, 85.3)
                (K-means, 87.9)
                (Agglomerative, 88.6)
                (Spectral, 86.1)
            };
            \addlegendentry{With KNN}
            
            \addplot[fill=orange!60, draw=black!50, thick, postaction={
                pattern=crosshatch, pattern color=orange!80!black
            }] coordinates {
                (DBSCAN, 83.8)
                (K-means, 86.5)
                (Agglomerative, 86.8)
                (Spectral, 84.7)
            };
            \addlegendentry{With Means}
            
            % Add performance improvement annotation
            \draw[<->, >=stealth, thick, red!60!black] (axis cs:Agglomerative,81) -- (axis cs:Agglomerative,87.5);
            \node[anchor=west, font=\scriptsize\bfseries, text=red!60!black] at (axis cs:Agglomerative,84) {+8.5\%};
            
        \end{axis}
    \end{tikzpicture}
    \caption{Detection rate comparison between traditional clustering algorithms and their enhanced versions in Scenario C (Near). Even in this challenging scenario where PUEA and PU are closely located, the enhanced versions with KNN show significant improvement of up to 8.5\%.}
    \label{fig:detection_comparison_C_enhanced}
\end{figure}
